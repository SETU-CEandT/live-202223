<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Computational Environments and Toolchains</title>

    <!-- Bootstrap core CSS -->
    <link href="../../../style/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../../../style/codehilite/css/default.css" rel="stylesheet">
    <link href="../../../style/misc/css/module.css" rel="stylesheet">
    <link href="../../../style/misc/css/practical.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

	<script type="text/javascript"
	  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>

  </head>

<body>

	<!-- Fixed navbar -->
	<div class="navbar navbar-default navbar-fixed-top" role="navigation">
		<div class="container">
			
			
	    	<div class="collapse navbar-collapse">

				<ul class="nav navbar-nav navbar-left">
					<!-- Moodle -->
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="https://moodle.wit.ie/course/view.php?id=192126" target="_blank"><img height="18pt" src="../../../style/misc/img/moodle_logo_on_blue.gif" /></a>
						</div>						
					</li>
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="https://moodle.wit.ie/course/view.php?id=192126" target="_blank"><img height="18pt" src="../../../style/misc/img/slack_logo.png" /></a>
						</div>						
					</li>
				</ul>

	      		<ul class="nav navbar-nav navbar-right">

					<!-- module home -->
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="../../../index.html"><span class="glyphicon glyphicon-home"></span></a>
						</div>						
					</li>
					
					<!-- topics -->
	        		<li>
						<div class="navbar-collapse collapse" id="b">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span class="glyphicon glyphicon-list-alt"></span>
									</a>
									<ul class="dropdown-menu" role="menu">
										<li class="dropdown-header">Topics</li>
										
										<li >
											<a href="../../../topics/01-Intro_to_Python/index.html">Intro to Python</a>
										</li>
										
										<li >
											<a href="../../../topics/02-Scientific_Computing_using_Python/index.html">Scientific Computing using Python</a>
										</li>
										
										<li >
											<a href="../../../topics/03-Computational_Problems_involving_Probability/index.html">Computational Problems involving Probability</a>
										</li>
										
										<li class="active">
											<a href="../../../topics/04-Implementing_Models/index.html">Implementing Models</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li>

					<!-- resources -->
	        		<li>
						<div class="navbar-collapse collapse" id="b">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span class="glyphicon glyphicon-th-list"></span>
									</a>
									<ul class="dropdown-menu" role="menu">
										<li class="dropdown-header">Resources</li>
										
										<li class="active">
											<a href="../../../topics/04-Implementing_Models/index.html#01-Nonlinear_Pendulum">Nonlinear Pendulum</a>
										</li>
										
										<li >
											<a href="../../../topics/04-Implementing_Models/index.html#02-Rocket_Launch">Rocket Launch</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li>
								
					<!-- pages-->
	        		<li>
						<div class="navbar-collapse collapse" id="c">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span>Linear Pendulum - Numeric</span
									</a>
									<ul class="dropdown-menu" role="menu">
										
										<li >
											<a href="00-Outline.html">Outline</a>
										</li>
										
										<li >
											<a href="01-Theory.html">Theory</a>
										</li>
										
										<li >
											<a href="02-Setup.html">Setup</a>
										</li>
										
										<li >
											<a href="03-Linear_Pendulum_-_Analytic.html">Linear Pendulum - Analytic</a>
										</li>
										
										<li class="active">
											<a href="04-Linear_Pendulum_-_Numeric.html">Linear Pendulum - Numeric</a>
										</li>
										
										<li >
											<a href="05-Linear_Pendulum_-_Parameter_Estimation.html">Linear Pendulum - Parameter Estimation</a>
										</li>
										
										<li >
											<a href="06-Nonlinear.html">Nonlinear</a>
										</li>
										
										<li >
											<a href="09-Period.html">Period</a>
										</li>
										
										<li >
											<a href="10-Assignment.html">Assignment</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li> 
					
	        	</ul>
			</div>
		</div>
	</div>

	<!-- contents -->
	<div class="container">
		
		<ul class="pager">
			
			<li class="previous"><a href="03-Linear_Pendulum_-_Analytic.html">&larr; Previous (Linear Pendulum - Analytic)</a></li>
			
			
			
			<li class="next"><a href="05-Linear_Pendulum_-_Parameter_Estimation.html">Next (Linear Pendulum - Parameter Estimation) &rarr;</a></li>
			
		</ul>
		
		<h1>Linear Pendulum (Numeric Solution)</h1>
<p><em>In this page we cover numerically solving the differential equations representing the linear pendulum. Why would we want to do this, when we have an analytic solution?  Well, there are differential equations for which no analytic solution exists. In those cases we have no option but the use a numerical solution. Hence it is a good idea to compare both solutions, when we can, so we get an understanding of how well they work.</em></p>
<p>Create a text cell and enter a level 2 heading with title <em>Linear Pendulum (Numeric Solution)</em>.</p>
<h2>Problem Type: Solving an ODE</h2>
<p>The <a href="https://scipy.org">scipy</a> library has two approaches for solving ordinary differential equations (ODE):</p>
<ul>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html">odeint</a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html">ode</a></li>
</ul>
<p><code>ode</code> is more powerful, but <code>odeint</code> is more than sufficient for our needs.</p>
<p>First, recall from you Maths that any \(n\)-th order differential equation can be converted to a 1st order system of \(n\) equations, The simplest approach, if given an \(n\)-th order in \(y(t)\), is define new variables:
\[
    u_0 = y,
    \qquad u_1 = \frac{d y}{dt},
    \qquad u_2 = \frac{d^2 y}{dt^2},
    \quad\ldots,
    \quad u_{n-1} = \frac{d^{n-1} y}{dt^{n-1}},
    \quad u_{n} = \frac{d^n y}{dt^n}
\]</p>
<p>Then we have a 1-st order system consisting of \(n\) equations, which when written in vector notation looks like:</p>
<p>\[
    \dot{\vec{u}} = \vec{f}(\vec{u},t)
\]</p>
<p>To use <code>odeint</code> we need to </p>
<ul>
<li>define a function that evaluates the right hand side of the ODE, the function \(f\).  In general this functions needs:<ul>
<li>the current state, \(\vec{u}\)</li>
<li>the current time, \(t\)</li>
<li>any problem parameters that are needed to evaluate the RHS</li>
</ul>
</li>
<li>define the range of independent variable and the step size (number of points).</li>
<li>call <code>odeint</code> with <ul>
<li>RHS function </li>
<li>initial conditions (as a vector)</li>
<li>independent variable points</li>
<li>(optional) list of problem parameters needed for RHS function</li>
</ul>
</li>
</ul>
<h2>Application to Linear Pendulum</h2>
<p>We apply the above process to our problem as follows:</p>
<p>This is a second order problem, and so can be converted to a first order system of two equations, on defining \(u=\theta, v=\dot\theta\),</p>
<p>\[
    \frac{d^2\theta}{dt^2} = -\frac{g}{L} \theta
    \qquad
    \to
    \qquad
    \frac{d\ }{dt}
    \left(\begin{array}{c}u \\ v\end{array}\right)
    =
    \left(\begin{array}{c}v \\ -\frac{g}{L} u\end{array}\right)
    \quad\text{with ic}
    \quad
    \left(\begin{array}{c}u \\ v\end{array}\right)
    =
    \left(\begin{array}{c}A \\ B\end{array}\right)
\]</p>
<p>Define the RHS function:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
  <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">g</span><span class="o">/</span><span class="n">L</span> <span class="o">*</span> <span class="n">u</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
<p>Define the range of independent variable and the step size (number of points):</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">tValues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>Call <code>odeint</code></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">linearNumeric</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">tValues</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
<p>The returned data will have shape \(n \times m\) where \(n\) is the number of equations (here is 2) and \(m\) is the number of independent variable points (here is 200). Use array slicing to get at the required data, so <code>linearNumeric[:,0]</code> to get position, \(u\), and <code>linearNumeric[:,1]</code> to get velocity, \(v\).</p>
<p>We now want to compare the numerical with the analytic solution to do this we run </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">linearAnalytic</span> <span class="o">=</span> <span class="n">getLinearAnalytic</span><span class="p">(</span><span class="n">tValues</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tValues</span><span class="p">,</span> <span class="n">linearNumeric</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;numeric&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tValues</span><span class="p">,</span> <span class="n">linearAnalytic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Numerical and analytic solution to Linear Problem ($L=</span><span class="si">%s</span><span class="s1">$, $g=</span><span class="si">%s</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">g</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time $t$ (sec)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;linear_numerical_and_analytic.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<p>to get </p>
<figure>
  <img src="files/linear_numerical_and_analytic.png" alt="" width="70%" >
  <figcaption>Numerical and analytical solution to linear pendulum.</figcaption>
</figure>

<p>As you can see the two solutions appear indistinguishable. To see any difference we need to plot the difference. Write code to generate the following graphic</p>
<figure>
  <img src="files/linear_numeric_error.png" alt="" width="70%" >
  <figcaption>Numerical and analytical solution to linear pendulum.</figcaption>
</figure>

<p>Note:</p>
<ul>
<li>Error tends to increase over time.</li>
</ul>
<h2>Function Implementation</h2>
<p>A function implementation that works like <code>getLinearAnalytic</code> and only returns the position is given below. Note:</p>
<ul>
<li>We only return the position, hence the <code>[:,0]</code> part</li>
<li>We use the python feature to define a local function inside another function since function <code>rhs</code> is only needed when calling <code>odeint</code>.</li>
<li>Now functions <code>getLinearAnalytic</code> and <code>getLinearNumeric</code> operate in the same way (same input/outputs).</li>
</ul>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">getLinearNumeric</span><span class="p">(</span><span class="n">tValues</span><span class="p">,</span> <span class="n">ic</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">g</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span><span class="n">L</span><span class="p">):</span>
      <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span>
      <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">g</span><span class="o">/</span><span class="n">L</span> <span class="o">*</span> <span class="n">u</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">odeint</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">tValues</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))[:,</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
		
		<ul class="pager">
			
			<li class="previous"><a href="03-Linear_Pendulum_-_Analytic.html">&larr; Previous (Linear Pendulum - Analytic)</a></li>
			
			
			
			<li class="next"><a href="05-Linear_Pendulum_-_Parameter_Estimation.html">Next (Linear Pendulum - Parameter Estimation) &rarr;</a></li>
			
		</ul>

	</div>
	
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="../../../style/bootstrap/js/bootstrap.min.js"></script>
	
  </body>
</html>